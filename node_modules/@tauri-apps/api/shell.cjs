"use strict";var p=Object.defineProperty;var g=Object.getOwnPropertyDescriptor;var m=Object.getOwnPropertyNames;var f=Object.prototype.hasOwnProperty;var y=(s,e)=>{for(var t in e)p(s,t,{get:e[t],enumerable:!0})},v=(s,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of m(e))!f.call(s,r)&&r!==t&&p(s,r,{get:()=>e[r],enumerable:!(n=g(e,r))||n.enumerable});return s};var w=s=>v(p({},"__esModule",{value:!0}),s);var T={};y(T,{Child:()=>c,Command:()=>u,EventEmitter:()=>a,open:()=>P});module.exports=w(T);function b(){return window.crypto.getRandomValues(new Uint32Array(1))[0]}function l(s,e=!1){let t=b(),n=`_${t}`;return Object.defineProperty(window,n,{value:r=>(e&&Reflect.deleteProperty(window,n),s==null?void 0:s(r)),writable:!1,configurable:!0}),t}async function h(s,e={}){return new Promise((t,n)=>{let r=l(i=>{t(i),Reflect.deleteProperty(window,`_${o}`)},!0),o=l(i=>{n(i),Reflect.deleteProperty(window,`_${r}`)},!0);window.__TAURI_IPC__({cmd:s,callback:r,error:o,...e})})}async function d(s){return h("tauri",s)}async function L(s,e,t=[],n){return typeof t=="object"&&Object.freeze(t),d({__tauriModule:"Shell",message:{cmd:"execute",program:e,args:t,options:n,onEventFn:l(s)}})}var a=class{constructor(){this.eventListeners=Object.create(null)}addListener(e,t){return this.on(e,t)}removeListener(e,t){return this.off(e,t)}on(e,t){return e in this.eventListeners?this.eventListeners[e].push(t):this.eventListeners[e]=[t],this}once(e,t){let n=(...r)=>{this.removeListener(e,n),t(...r)};return this.addListener(e,n)}off(e,t){return e in this.eventListeners&&(this.eventListeners[e]=this.eventListeners[e].filter(n=>n!==t)),this}removeAllListeners(e){return e?delete this.eventListeners[e]:this.eventListeners=Object.create(null),this}emit(e,...t){if(e in this.eventListeners){let n=this.eventListeners[e];for(let r of n)r(...t);return!0}return!1}listenerCount(e){return e in this.eventListeners?this.eventListeners[e].length:0}prependListener(e,t){return e in this.eventListeners?this.eventListeners[e].unshift(t):this.eventListeners[e]=[t],this}prependOnceListener(e,t){let n=(...r)=>{this.removeListener(e,n),t(...r)};return this.prependListener(e,n)}},c=class{constructor(e){this.pid=e}async write(e){return d({__tauriModule:"Shell",message:{cmd:"stdinWrite",pid:this.pid,buffer:typeof e=="string"?e:Array.from(e)}})}async kill(){return d({__tauriModule:"Shell",message:{cmd:"killChild",pid:this.pid}})}},u=class extends a{constructor(t,n=[],r){super();this.stdout=new a;this.stderr=new a;this.program=t,this.args=typeof n=="string"?[n]:n,this.options=r??{}}static sidecar(t,n=[],r){let o=new u(t,n,r);return o.options.sidecar=!0,o}async spawn(){return L(t=>{switch(t.event){case"Error":this.emit("error",t.payload);break;case"Terminated":this.emit("close",t.payload);break;case"Stdout":this.stdout.emit("data",t.payload);break;case"Stderr":this.stderr.emit("data",t.payload);break}},this.program,this.args,this.options).then(t=>new c(t))}async execute(){return new Promise((t,n)=>{this.on("error",n);let r=[],o=[];this.stdout.on("data",i=>{r.push(i)}),this.stderr.on("data",i=>{o.push(i)}),this.on("close",i=>{t({code:i.code,signal:i.signal,stdout:r.join(`
`),stderr:o.join(`
`)})}),this.spawn().catch(n)})}};async function P(s,e){return d({__tauriModule:"Shell",message:{cmd:"open",path:s,with:e}})}
